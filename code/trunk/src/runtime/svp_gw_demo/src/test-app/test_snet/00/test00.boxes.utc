#include "test00.snet.utc.h"

#define T 0
// #define PRINT_STDOUT  

/*----------------------------------------------------------------------------*/
/*----------------------------------------------------------------------------*/

int SNetCall__A(snet_handle_t *hnd, void *field_a)
{
  if (field_a == NULL) {
#ifdef PRINT_STDOUT  
      printf(
        "Executing box A "
        "(invalid field values; emitting no records)\n");
#endif
      return 0;
  }


  int *res = (int *) malloc(sizeof(int));

  (*res) = 2 * (*((int *) field_a));

  if (rand() % 10 > 5) {
#ifdef PRINT_STDOUT  
      printf(
        "Executing box A "
        "(a=%d ==> venc_inx=0, b=%d)\n",
        *((int *) field_a), *res);
#endif

      SNetOutRaw(hnd, 0, 0, res);

  } else {
#ifdef PRINT_STDOUT  
      printf(
        "Executing box A "
        "(a=%d ==> venc_inx=1, b=%d, <T>=0)\n",
        *((int *) field_a), *res);
#endif

      SNetOutRaw(hnd, 0, 1, res, 1);
  }

  return 0;
}

/*----------------------------------------------------------------------------*/

int SNetCall__B(snet_handle_t *hnd, void *field_b)
{
  if (field_b == NULL) {
#ifdef PRINT_STDOUT  
      printf(
        "Executing box B "
        "(invalid field values; emitting no records)\n");
#endif
      return 0;
  }

  int *res = (int *) malloc(sizeof(int));

  if (rand() % 10 > 5) {
      (*res) = 2 * (*((int *) field_b));

#ifdef PRINT_STDOUT  
      printf(
        "Executing box B "
        "(b=%d ==> venc_inx=0, c=%d)\n",
        *((int *) field_b), *res);
#endif

      SNetOutRaw(hnd, 0, 0, res);

  } else {
      (*res) = 10 * (*((int *) field_b));

#ifdef PRINT_STDOUT  
      printf(
        "Executing box B "
        "(b=%d ==> venc_inx=1, d=%d)\n",
        *((int *) field_b), *res);
#endif

      SNetOutRaw(hnd, 0, 1, res);
  }

  return 0;
}

/*----------------------------------------------------------------------------*/

int SNetCall__C(snet_handle_t *hnd, void *field_c)
{
  if (field_c == NULL) {
#ifdef PRINT_STDOUT  
      printf(
        "Executing box C "
        "(invalid field values; emitting no records)\n");
#endif
      return 0;
  }

  int *res = (int *) malloc(sizeof(int));

  if (rand() % 10 > 3) {
      (*res) = 100 * (*((int *) field_c));

#ifdef PRINT_STDOUT  
      printf(
        "Executing box C "
        "(c=%d ==> venc_inx=0, b=%d)\n",
        *((int *) field_c), *res);
#endif

      SNetOutRaw(hnd, 0, 0, res);

  } else if (rand() % 10 > 6) {
      (*res) = 1000 * (*((int *) field_c));

#ifdef PRINT_STDOUT  
      printf(
        "Executing box C "
        "(c=%d ==> venc_inx=1, b=%d, <T>=10)\n",
        *((int *) field_c), *res);
#endif

      SNetOutRaw(hnd, 0, 1, res, T + (int) rand() % 10);

  } else {
      int  t_tag = T + (int) rand() % 10;
      int *res1  = (int *) malloc(sizeof(int));

      (*res)  = 10000 * (*((int *) field_c));
      (*res1) = 100   * (*((int *) field_c));

#ifdef PRINT_STDOUT  
      printf(
        "Executing box C "
        "(d=%d ==> venc_inx=2, b=%d, e=%d, <T>=%d)\n",
        *((int *) field_c), *res, *res1, t_tag);
#endif

      SNetOutRaw(hnd, 0, 2, res, res1, t_tag);
  }

  return 0;
}

/*----------------------------------------------------------------------------*/

int SNetCall__D(snet_handle_t *hnd, void *field_d)
{
  if (field_d == NULL) {
#ifdef PRINT_STDOUT  
      printf(
        "Executing box D "
        "(invalid field values; emitting no records)\n");
#endif
      return 0;
  }

  int *res = (int *) malloc(sizeof(int));

  if (rand() % 10 > 3) {
      (*res) = 100 * (*((int *) field_d));

#ifdef PRINT_STDOUT  
      printf(
        "Executing box D "
        "(d=%d ==> venc_inx=0, b=%d)\n",
        *((int *) field_d), *res);
#endif

      SNetOutRaw(hnd, 0, 0, res);
  } else if (rand() % 10 > 6) {
      int *res1  = (int *) malloc(sizeof(int));

      (*res) = 1000 * (*((int *) field_d));
      (*res1) = 100   * (*((int *) field_d));

#ifdef PRINT_STDOUT  
      printf(
        "Executing box D "
        "(d=%d ==> venc_inx=1, b(1)=%d, b(2)=%d <T>=10)\n",
        *((int *) field_d), *res, *res1);
#endif

      SNetOutRaw(hnd, 0, 1, res, T + (int) rand() % 10);
      SNetOutRaw(hnd, 0, 1, res1, T + (int) rand() % 10);

  } else {
      int  t_tag = T + (int) rand() % 10;
      int *res1  = (int *) malloc(sizeof(int));

      (*res)  = 10000 * (*((int *) field_d));
      (*res1) = 100   * (*((int *) field_d));

#ifdef PRINT_STDOUT  
      printf(
        "Executing box D "
        "(d=%d ==> venc_inx=2, b=%d, e=%d, <T>=%d)\n",
        *((int *) field_d), *res, *res1, t_tag);
#endif

      SNetOutRaw(hnd, 0, 2, res, res1, t_tag);
  }

  return 0;
}

/*----------------------------------------------------------------------------*/

int SNetCall__E(snet_handle_t *hnd, void *field_e)
{
  if (field_e == NULL) {
#ifdef PRINT_STDOUT  
      printf(
        "Executing box E "
        "(invalid field values; emitting no records)\n");
#endif
      return 0;
  }

  int *res = (int *) malloc(sizeof(int));

  (*res) = 1000 * (*((int *) field_e));

#ifdef PRINT_STDOUT  
  printf(
    "Executing box E "
    "(e=%d ==> venc_inx=0, f=%d)\n",
    *((int *) field_e), *res);
#endif

  SNetOutRaw(hnd, 0, 0, res);

  return 0;
}

/*----------------------------------------------------------------------------*/
/*----------------------------------------------------------------------------*/

